<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="test_files/libs/clipboard/clipboard.min.js"></script>
<script src="test_files/libs/quarto-html/quarto.js"></script>
<script src="test_files/libs/quarto-html/popper.min.js"></script>
<script src="test_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="test_files/libs/quarto-html/anchor.min.js"></script>
<link href="test_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="test_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="test_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="test_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="test_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<p>This section contains general information on each profile.</p>
<p>Each item of this section has a N_PROF (number of profiles) dimension.</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><strong>Name</strong></td>
<td><strong>Definition</strong>****</td>
<td><strong>Comment</strong></td>
</tr>
<tr class="even">
<td>PLATFORM_NUMBER</td>
<td>char PLATFORM_NUMBER(N_PROF, STRING8);PLATFORM_NUMBER:long_name = “Float unique identifier”;PLATFORM_NUMBER:conventions = “WMO float identifier : A9IIIII”;PLATFORM_NUMBER:_FillValue = ” “;</td>
<td>WMO float identifier.WMO is the World Meteorological Organization.This platform number is unique.Example&nbsp;: 6900045</td>
</tr>
<tr class="odd">
<td>PROJECT_NAME</td>
<td>char PROJECT_NAME(N_PROF, STRING64);PROJECT_NAME:long_name = “Name of the project”;PROJECT_NAME:_FillValue = ” “;</td>
<td>Name of the project which operates the profiling float that performed the profile.Example&nbsp;: “GYROSCOPE” (EU project for ARGO program)</td>
</tr>
<tr class="even">
<td>PI_NAME</td>
<td>char PI_NAME (N_PROF, STRING64);PI_NAME:long_name = “Name of the principal investigator”;PI_NAME:_FillValue = ” “;</td>
<td>Name of the principal investigator responsible for the profiling float. Example: “Julia UITZ”.Valid PI names are listed in reference table R40 ( <a href="https://vocab.nerc.ac.uk/collectionsearch_nvs/R40/">https://vocab.nerc.ac.uk/collection/R40/</a>). Multiple names can be concatenated, separated by commas.</td>
</tr>
<tr class="odd">
<td>STATION_PARAMETERS</td>
<td>char STATION_PARAMETERS(N_PROF, N_PARAM, STRING16);STATION_PARAMETERS:long_name = “List of available parameters for the station”;STATION_PARAMETERS:conventions = “Argo reference table 3”;STATION_PARAMETERS:_FillValue = ” “;</td>
<td>List of parameters contained in this profile.The parameter names are listed in reference table 3 (https://vocab.nerc.ac.uk/collection/R03/).Examples&nbsp;: TEMP, PSAL, CNDCTEMP&nbsp;: temperaturePSAL&nbsp;: practical salinityCNDC&nbsp;: conductivity</td>
</tr>
<tr class="even">
<td>CYCLE_NUMBER</td>
<td>int CYCLE_NUMBER(N_PROF);CYCLE_NUMBER:long_name = “Float cycle number”;CYCLE_NUMBER:conventions = “0…N, 0 : launch cycle (if exists), 1 : first complete cycle”;CYCLE_NUMBER:_FillValue = 99999;</td>
<td>Float cycle number.See §1.6: float cycle definition.</td>
</tr>
<tr class="odd">
<td>DIRECTION</td>
<td>char DIRECTION(N_PROF);DIRECTION:long_name = “Direction of the station profiles”;DIRECTION:conventions = “A: ascending profiles, D: descending profiles”;DIRECTION:_FillValue = ” “;</td>
<td>Type of profile on which measurement occurs.A&nbsp;: ascending profileD&nbsp;: descending profile</td>
</tr>
<tr class="even">
<td>DATA_CENTRE</td>
<td>char DATA_CENTRE(N_PROF, STRING2);DATA_CENTRE:long_name = “Data centre in charge of float data processing”;DATA_CENTRE:conventions = “Argo reference table 4”;DATA_CENTRE:_FillValue = ” “;</td>
<td>Code for the data centre in charge of the float data management.The data centre codes are described in the reference table 4 (https://vocab.nerc.ac.uk/collection/R04/).Example&nbsp;: “ME” for MEDS</td>
</tr>
<tr class="odd">
<td>DC_REFERENCE</td>
<td>char DC_REFERENCE(N_PROF, STRING32);DC_REFERENCE:long_name = “Station unique identifier in data centre”;DC_REFERENCE:conventions = “Data centre convention”;DC_REFERENCE:_FillValue = ” “;</td>
<td>Unique identifier of the profile in the data centre.Data centres may have different identifier schemes.DC_REFERENCE is therefore not unique across data centres.</td>
</tr>
<tr class="even">
<td>DATA_STATE_INDICATOR</td>
<td>char DATA_STATE_INDICATOR(N_PROF, STRING4);DATA_STATE_INDICATOR:long_name = “Degree of processing the data have passed through”;DATA_STATE_INDICATOR:conventions = “Argo reference table 6”;DATA_STATE_INDICATOR:_FillValue = ” “;</td>
<td>Degree of processing the data has passed through.The data state indicator is described in the reference table 6 (https://vocab.nerc.ac.uk/collection/R06/).</td>
</tr>
<tr class="odd">
<td>DATA_MODE</td>
<td>char DATA_MODE(N_PROF);DATA_MODE:long_name = “Delayed mode or real time data”;DATA_MODE:conventions = “R : real time; D : delayed mode; A : real time with adjustment”;DATA_MODE:_FillValue = ” “;</td>
<td>Indicates if the profile contains real time, delayed mode or adjusted data.R&nbsp;: real time dataD&nbsp;: delayed mode dataA : real time data with adjusted values</td>
</tr>
<tr class="even">
<td>PLATFORM_TYPE</td>
<td>char PLATFORM_TYPE(N_PROF, STRING32);PLATFORM_TYPE:long_name = “Type of float”;PLATFORM_TYPE:conventions = “Argo reference table 23”;PLATFORM_TYPE:_FillValue = ” “;&nbsp;</td>
<td>Type of float listed in reference table 23 (https://vocab.nerc.ac.uk/collection/R23/).Example: SOLO, APEX, PROVOR, ARVOR, NINJA</td>
</tr>
<tr class="odd">
<td>FLOAT_SERIAL_NO</td>
<td>char FLOAT_SERIAL_NO(N_PROF, STRING32);FLOAT_SERIAL_NO:long_name = “Serial number of the float”;FLOAT_SERIAL_NO:_FillValue = ” “;</td>
<td>Serial number of the float.Example 1679</td>
</tr>
<tr class="even">
<td>FIRMWARE_VERSION</td>
<td>char FIRMWARE_VERSION(N_PROF, STRING64);FIRMWARE_VERSION:long_name = “Instrument firmware version”;FIRMWARE_VERSION:_FillValue = ” “;</td>
<td>Firmware version of the float.Example : “013108”The dimension STRING32 instead of STRING64 remains accepted.</td>
</tr>
<tr class="odd">
<td>WMO_INST_TYPE</td>
<td>char WMO_INST_TYPE(N_PROF, STRING4);WMO_INST_TYPE:long_name = “Coded instrument type”;WMO_INST_TYPE:conventions = “Argo reference table 8”;WMO_INST_TYPE:_FillValue = ” “;</td>
<td>Instrument type from WMO code table 1770.A subset of WMO table 1770 is documented in the reference table 8 (https://vocab.nerc.ac.uk/collection/R08/).Example&nbsp;:&nbsp;846 : Webb Research float, Seabird sensor</td>
</tr>
<tr class="even">
<td>JULD</td>
<td>double JULD(N_PROF);JULD:long_name = “Julian day (UTC) of the station relative to REFERENCE_DATE_TIME”;JULD:standard_name = “time”;JULD:units = “days since 1950-01-01 00:00:00 UTC”;JULD:conventions = “Relative julian days with decimal part (as parts of day)”;JULD:resolution = X;JULD:_FillValue = 999999.;JULD:axis = “T”;</td>
<td>Julian day of the profile.The integer part represents the day, the decimal part represents the time of the profile.Date and time are in Universal Time.The Julian day is relative to REFERENCE_DATE_TIME.Example&nbsp;:18833.8013889885&nbsp;: July 25 2001 19:14:00</td>
</tr>
<tr class="odd">
<td>JULD_QC</td>
<td>char JULD_QC(N_PROF);JULD_QC:long_name = “Quality on date and time”;JULD_QC:conventions = “Argo reference table 2”;JULD_QC:_FillValue = ” “;</td>
<td>Quality flag on JULD date and time.The flag scale is described in the reference tables 2 (https://vocab.nerc.ac.uk/collection/RR2/ for real time and https://vocab.nerc.ac.uk/collection/RD2/ for delayed mode).Example&nbsp;:1: the date and time seems correct.</td>
</tr>
<tr class="even">
<td>JULD_LOCATION</td>
<td>double JULD_LOCATION(N_PROF);JULD_LOCATION:long_name = “Julian day (UTC) of the location relative to REFERENCE_DATE_TIME”;JULD_LOCATION:units = “days since 1950-01-01 00:00:00 UTC”;JULD_LOCATION:conventions = “Relative julian days with decimal part (as parts of day)”;JULD_LOCATION:resolution = X;JULD_LOCATION:_FillValue = 999999.;</td>
<td>Julian day of the location of the profile.The integer part represents the day, the decimal part represents the time of the profile.Date and time are in Universal Time.The Julian day is relative to REFERENCE_DATE_TIME.Example&nbsp;:18833.8013889885&nbsp;: July 25 2001 19:14:00</td>
</tr>
<tr class="odd">
<td>LATITUDE</td>
<td>double LATITUDE(N_PROF);LATITUDE:long_name = “Latitude of the station, best estimate”;LATITUDE:standard_name = “latitude”;LATITUDE:units = “degree_north”;LATITUDE:_FillValue = 99999.;LATITUDE:valid_min = -90.;LATITUDE:valid_max = 90.;LATITUDE:axis = “Y”;</td>
<td>Latitude of the profile.Unit&nbsp;: degree northThis field contains the best estimated latitude.The latitude value may be improved in delayed mode.The measured locations of the float are located in the trajectory file.Example&nbsp;: 44.4991&nbsp;: 44° 29’ 56.76’’ N</td>
</tr>
<tr class="even">
<td>LONGITUDE</td>
<td>double LONGITUDE(N_PROF);LONGITUDE:long_name = “Longitude of the station, best estimate”;LONGITUDE:standard_name = “longitude”;LONGITUDE:units = “degree_east”;LONGITUDE:_FillValue = 99999.;LONGITUDE:valid_min = -180.;LONGITUDE:valid_max = 180.;LONGITUDE:axis = “X”;</td>
<td>Longitude of the profile.Unit&nbsp;: degree eastThis field contains the best estimated longitude.The longitude value may be improved in delayed mode.The measured locations of the float are located in the trajectory file.Example&nbsp;: 16.7222&nbsp;: 16° 43’ 19.92’’ E</td>
</tr>
<tr class="odd">
<td>POSITION_QC</td>
<td>char POSITION_QC(N_PROF);POSITION_QC:long_name = “Quality on position (latitude and longitude)”;POSITION_QC:conventions = “Argo reference table 2”;POSITION_QC:_FillValue = ” “;</td>
<td>Quality flag on position.The flag on position is set according to (LATITUDE, LONGITUDE) quality.The flag scale is described in the reference tables 2 (<a href="https://vocab.nerc.ac.uk/collection/RR2/" class="uri">https://vocab.nerc.ac.uk/collection/RR2/</a> for real time and <a href="https://vocab.nerc.ac.uk/collection/RD2/" class="uri">https://vocab.nerc.ac.uk/collection/RD2/</a> for delayed mode).Example: 1: position seems correct.</td>
</tr>
<tr class="even">
<td>POSITIONING_SYSTEM</td>
<td>char POSITIONING_SYSTEM(N_PROF, STRING8);POSITIONING_SYSTEM:long_name = “Positioning system”;POSITIONING_SYSTEM:_FillValue = ” “;</td>
<td>Name of the system in charge of positioning the float locations from reference table 9 (<a href="https://vocab.nerc.ac.uk/collection/R09/" class="uri">https://vocab.nerc.ac.uk/collection/R09/</a>).Examples&nbsp;: ARGOS</td>
</tr>
<tr class="odd">
<td>POSITION_ERROR_REPORTED</td>
<td>float POSITION_ERROR_REPORTED(N_PROF);POSITION_ERROR_REPORTED:long_name = “Position error reported by the positioning system”;POSITION_ERROR_REPORTED:units = “meters”;POSITION_ERROR_REPORTED:_FillValue = 99999.;</td>
<td><strong>This is an optional variable.</strong>Position error reported by the positioning system.</td>
</tr>
<tr class="even">
<td>POSITION_ERROR_ESTIMATED</td>
<td>float POSITION_ERROR_ESTIMATED(N_PROF);POSITION_ERROR_ESTIMATED:long_name = “Position error estimated by the real-time or delayed-mode process”;POSITION_ERROR_ESTIMATED:units = “meters”;POSITION_ERROR_ESTIMATED:_FillValue = 99999.;</td>
<td><strong>This is an optional variable.</strong> Position error estimated&nbsp; by the real-time or delayed-mode process.&nbsp;</td>
</tr>
<tr class="odd">
<td>POSITION_ERROR_ESTIMATED_COMMENT</td>
<td>char POSITION_ERROR_ESTIMATED_COMMENT(N_PROF, STRING1024);POSITION_ERROR_ESTIMATED_COMMENT:long_name = “Comment on the method used to determine POSITION_ERROR_ESTIMATED”;POSITION_ERROR_ESTIMATED_COMMENT:_FillValue = ” “;</td>
<td><strong>This is an optional variable.</strong>Comment on the method used to determine POSITION_ERROR_ESTIMATED.</td>
</tr>
<tr class="even">
<td>PROFILE_&lt;PARAM&gt;_QC</td>
<td>char PROFILE_&lt;PARAM&gt;_QC(N_PROF);PROFILE_&lt;PARAM&gt;_QC:long_name = “Global quality flag of &lt;PARAM&gt; profile”;PROFILE_&lt;PARAM&gt;_QC:conventions = “Argo reference table 2a”;PROFILE_&lt;PARAM&gt;_QC:_FillValue = ” “;</td>
<td>Global quality flag on the PARAM profile.PARAM is among the STATION_PARAMETERS.The overall flag is set to indicate the percentage of good data in the profile as described in reference table 2a (<a href="https://vocab.nerc.ac.uk/collection/RP2/" class="uri">https://vocab.nerc.ac.uk/collection/RP2/</a>).Example&nbsp;:PROFILE_TEMP_QC = A : the temperature profile contains only good valuesPROFILE_PSAL_QC = C : the salinity profile contains 50% to 75% good values</td>
</tr>
<tr class="odd">
<td>VERTICAL_SAMPLING_SCHEME</td>
<td>char VERTICAL_SAMPLING_SCHEME(N_PROF, STRING256);VERTICAL_SAMPLING_SCHEME:long_name = “Vertical sampling scheme”;VERTICAL_SAMPLING_SCHEME:conventions = “Argo reference table 16”;VERTICAL_SAMPLING_SCHEME:_FillValue = ” “;</td>
<td>Use the vertical sampling scheme to differentiate and identify profiles from a single-cycle with different vertical sampling schemes.See reference table 16 (<a href="https://vocab.nerc.ac.uk/collection/R16/" class="uri">https://vocab.nerc.ac.uk/collection/R16/</a>).</td>
</tr>
<tr class="even">
<td>CONFIG_MISSION_NUMBER</td>
<td>int CONFIG_MISSION_NUMBER(N_PROF);CONFIG_MISSION_NUMBER:long_name = ” Unique number denoting the missions performed by the float”;CONFIG_MISSION_NUMBER:conventions = “1…N, 1 : first complete mission”;CONFIG_MISSION_NUMBER:_FillValue = 99999;</td>
<td>Unique number of the mission to which this profile belongs.See note on floats with multiple configurations §2.4.6.1.The number 0 (zero) can be used to denote the float’s mission prelude, if it exists.</td>
</tr>
</tbody>
</table>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>